/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2013 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.ui.core.LocalBusyIndicatorSupport");jQuery.sap.require("sap.ui.core.Popup");
sap.ui.core.LocalBusyIndicatorSupport=function(){if(this instanceof sap.ui.core.Control){this._sapUiCoreLocalBusy_isBusy=false;this._sapUiCoreLocalBusy_oPopup;this._sapUiCoreLocalBusy_busyIndicator;this._sapUiCoreLocalBusy_delay=1000;this.setBusy=function(b){if(this._sapUiCoreLocalBusy_isBusy===b){return}this._sapUiCoreLocalBusy_isBusy=b;if(b){if(this._sapUiCoreLocalBusy_busyIndicator){delete this._sapUiCoreLocalBusy_busyIndicator}var $=this.$();var w=$.outerWidth()+"px";var h=$.outerHeight()+"px";this._sapUiCoreLocalBusy_busyIndicator=new sap.ui.core.LocalBusyIndicator({width:w,height:h});this._sapUiCoreLocalBusy_oPopup=new sap.ui.core.Popup(this._sapUiCoreLocalBusy_busyIndicator,false,false,false);this._sapUiCoreLocalBusy_oPopup.attachOpened(jQuery.proxy(this._sapUiCoreLocalBusyPopupOpened,this));this._sapUiCoreLocalBusy_oPopup.attachClosed(jQuery.proxy(this._sapUiCoreLocalBusyPopupClosed,this));this._delayedCallId=jQuery.sap.delayedCall(this._sapUiCoreLocalBusy_delay,this,"_sapUiCoreLocalBusyPopupOpen")}else{if(this._delayedCallId){jQuery.sap.clearDelayedCall(this._delayedCallId);delete this._delayedCallId;if(this._sapUiCoreLocalBusy_busyIndicator){this._sapUiCoreLocalBusy_busyIndicator.destroy();delete this._sapUiCoreLocalBusy_busyIndicator}}this._sapUiCoreLocalBusy_oPopup.close()}};this.isBusy=function(){return this._sapUiCoreLocalBusy_isBusy};this.setDelay=function(d){this._sapUiCoreLocalBusy_delay=d};this.getDelay=function(){return this._sapUiCoreLocalBusy_delay};this._sapUiCoreLocalBusyPopupOpen=function(){this._sapUiCoreLocalBusy_oPopup.open(sap.ui.core.Popup.Dock.BeginTop,sap.ui.core.Popup.Dock.BeginTop,this,"0 0",null,true)};this._sapUiCoreLocalBusyPopupOpened=function(){jQuery.sap.clearDelayedCall(this._delayedCallId);delete this._delayedCallId};this._sapUiCoreLocalBusyPopupClosed=function(){jQuery.sap.clearDelayedCall(this._delayedCallId);delete this._delayedCallId;if(this._sapUiCoreLocalBusy_busyIndicator){this._sapUiCoreLocalBusy_busyIndicator.destroy();delete this._sapUiCoreLocalBusy_busyIndicator}};this._sapUiCoreLocalBusy_Exit=function(){delete this._sapUiCoreLocalBusy_isBusy;if(this._delayedCallId){jQuery.sap.clearDelayedCall(this._delayedCallId);delete this._delayedCallId}if(this._sapUiCoreLocalBusy_busyIndicator){this._sapUiCoreLocalBusy_busyIndicator.destroy();delete this._sapUiCoreLocalBusy_busyIndicator}if(this._sapUiCoreLocalBusy_oPopup){this._sapUiCoreLocalBusy_oPopup.detachClosed(jQuery.proxy(this.sapUiCoreLocalBusyPopupClosed,this));this._sapUiCoreLocalBusy_oPopup.destroy();delete this._sapUiCoreLocalBusy_oPopup}}}else{jQuery.sap.log.error("Only controls can use the LocalBusyIndicator",this)}};
