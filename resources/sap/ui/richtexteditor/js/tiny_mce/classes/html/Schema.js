/**
 * Schema.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
(function(t){var m={},a=t.makeMap,e=t.each;function s(c,d){return c.split(d||',')};function u(l,d){var k,c={};function r(v){return v.replace(/[A-Z]+/g,function(k){return r(l[k])})};for(k in l){if(l.hasOwnProperty(k))l[k]=r(l[k])}r(d).replace(/#/g,'#text').replace(/(\w+)\[([^\]]+)\]\[([^\]]*)\]/g,function(f,n,h,i){h=s(h,'|');c[n]={attributes:a(h),attributesOrder:h,children:a(i,'|',{'#comment':{}})}});return c};function g(){var h=m.html5;if(!h){h=m.html5=u({A:'id|accesskey|class|dir|draggable|item|hidden|itemprop|role|spellcheck|style|subject|title|onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup',B:'#|a|abbr|area|audio|b|bdo|br|button|canvas|cite|code|command|datalist|del|dfn|em|embed|i|iframe|img|input|ins|kbd|keygen|label|link|map|mark|meta|'+'meter|noscript|object|output|progress|q|ruby|samp|script|select|small|span|strong|sub|sup|svg|textarea|time|var|video|wbr',C:'#|a|abbr|area|address|article|aside|audio|b|bdo|blockquote|br|button|canvas|cite|code|command|datalist|del|details|dfn|dialog|div|dl|em|embed|fieldset|'+'figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|i|iframe|img|input|ins|kbd|keygen|label|link|map|mark|menu|meta|meter|nav|noscript|ol|object|output|'+'p|pre|progress|q|ruby|samp|script|section|select|small|span|strong|style|sub|sup|svg|table|textarea|time|ul|var|video'},'html[A|manifest][body|head]'+'head[A][base|command|link|meta|noscript|script|style|title]'+'title[A][#]'+'base[A|href|target][]'+'link[A|href|rel|media|type|sizes][]'+'meta[A|http-equiv|name|content|charset][]'+'style[A|type|media|scoped][#]'+'script[A|charset|type|src|defer|async][#]'+'noscript[A][C]'+'body[A][C]'+'section[A][C]'+'nav[A][C]'+'article[A][C]'+'aside[A][C]'+'h1[A][B]'+'h2[A][B]'+'h3[A][B]'+'h4[A][B]'+'h5[A][B]'+'h6[A][B]'+'hgroup[A][h1|h2|h3|h4|h5|h6]'+'header[A][C]'+'footer[A][C]'+'address[A][C]'+'p[A][B]'+'br[A][]'+'pre[A][B]'+'dialog[A][dd|dt]'+'blockquote[A|cite][C]'+'ol[A|start|reversed][li]'+'ul[A][li]'+'li[A|value][C]'+'dl[A][dd|dt]'+'dt[A][B]'+'dd[A][C]'+'a[A|href|target|ping|rel|media|type][B]'+'em[A][B]'+'strong[A][B]'+'small[A][B]'+'cite[A][B]'+'q[A|cite][B]'+'dfn[A][B]'+'abbr[A][B]'+'code[A][B]'+'var[A][B]'+'samp[A][B]'+'kbd[A][B]'+'sub[A][B]'+'sup[A][B]'+'i[A][B]'+'b[A][B]'+'mark[A][B]'+'progress[A|value|max][B]'+'meter[A|value|min|max|low|high|optimum][B]'+'time[A|datetime][B]'+'ruby[A][B|rt|rp]'+'rt[A][B]'+'rp[A][B]'+'bdo[A][B]'+'span[A][B]'+'ins[A|cite|datetime][B]'+'del[A|cite|datetime][B]'+'figure[A][C|legend|figcaption]'+'figcaption[A][C]'+'img[A|alt|src|height|width|usemap|ismap][]'+'iframe[A|name|src|height|width|sandbox|seamless][]'+'embed[A|src|height|width|type][]'+'object[A|data|type|height|width|usemap|name|form|classid][param]'+'param[A|name|value][]'+'details[A|open][C|legend]'+'command[A|type|label|icon|disabled|checked|radiogroup][]'+'menu[A|type|label][C|li]'+'legend[A][C|B]'+'div[A][C]'+'source[A|src|type|media][]'+'audio[A|src|autobuffer|autoplay|loop|controls][source]'+'video[A|src|autobuffer|autoplay|loop|controls|width|height|poster][source]'+'hr[A][]'+'form[A|accept-charset|action|autocomplete|enctype|method|name|novalidate|target][C]'+'fieldset[A|disabled|form|name][C|legend]'+'label[A|form|for][B]'+'input[A|type|accept|alt|autocomplete|autofocus|checked|disabled|form|formaction|formenctype|formmethod|formnovalidate|formtarget|height|list|max|maxlength|min|'+'multiple|pattern|placeholder|readonly|required|size|src|step|width|files|value|name][]'+'button[A|autofocus|disabled|form|formaction|formenctype|formmethod|formnovalidate|formtarget|name|value|type][B]'+'select[A|autofocus|disabled|form|multiple|name|size][option|optgroup]'+'datalist[A][B|option]'+'optgroup[A|disabled|label][option]'+'option[A|disabled|selected|label|value][]'+'textarea[A|autofocus|disabled|form|maxlength|name|placeholder|readonly|required|rows|cols|wrap][]'+'keygen[A|autofocus|challenge|disabled|form|keytype|name][]'+'output[A|for|form|name][B]'+'canvas[A|width|height][]'+'map[A|name][B|C]'+'area[A|shape|coords|href|alt|target|media|rel|ping|type][]'+'mathml[A][]'+'svg[A][]'+'table[A|border][caption|colgroup|thead|tfoot|tbody|tr]'+'caption[A][C]'+'colgroup[A|span][col]'+'col[A|span][]'+'thead[A][tr]'+'tfoot[A][tr]'+'tbody[A][tr]'+'tr[A][th|td]'+'th[A|headers|rowspan|colspan|scope][B]'+'td[A|headers|rowspan|colspan][C]'+'wbr[A][]')}return h};function b(){var h=m.html4;if(!h){h=m.html4=u({Z:'H|K|N|O|P',Y:'X|form|R|Q',ZG:'E|span|width|align|char|charoff|valign',X:'p|T|div|U|W|isindex|fieldset|table',ZF:'E|align|char|charoff|valign',W:'pre|hr|blockquote|address|center|noframes',ZE:'abbr|axis|headers|scope|rowspan|colspan|align|char|charoff|valign|nowrap|bgcolor|width|height',ZD:'[E][S]',U:'ul|ol|dl|menu|dir',ZC:'p|Y|div|U|W|table|br|span|bdo|object|applet|img|map|K|N|Q',T:'h1|h2|h3|h4|h5|h6',ZB:'X|S|Q',S:'R|P',ZA:'a|G|J|M|O|P',R:'a|H|K|N|O',Q:'noscript|P',P:'ins|del|script',O:'input|select|textarea|label|button',N:'M|L',M:'em|strong|dfn|code|q|samp|kbd|var|cite|abbr|acronym',L:'sub|sup',K:'J|I',J:'tt|i|b|u|s|strike',I:'big|small|font|basefont',H:'G|F',G:'br|span|bdo',F:'object|applet|img|map|iframe',E:'A|B|C',D:'accesskey|tabindex|onfocus|onblur',C:'onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup',B:'lang|xml:lang|dir',A:'id|class|style|title'},'script[id|charset|type|language|src|defer|xml:space][]'+'style[B|id|type|media|title|xml:space][]'+'object[E|declare|classid|codebase|data|type|codetype|archive|standby|width|height|usemap|name|tabindex|align|border|hspace|vspace][#|param|Y]'+'param[id|name|value|valuetype|type][]'+'p[E|align][#|S]'+'a[E|D|charset|type|name|href|hreflang|rel|rev|shape|coords|target][#|Z]'+'br[A|clear][]'+'span[E][#|S]'+'bdo[A|C|B][#|S]'+'applet[A|codebase|archive|code|object|alt|name|width|height|align|hspace|vspace][#|param|Y]'+'h1[E|align][#|S]'+'img[E|src|alt|name|longdesc|width|height|usemap|ismap|align|border|hspace|vspace][]'+'map[B|C|A|name][X|form|Q|area]'+'h2[E|align][#|S]'+'iframe[A|longdesc|name|src|frameborder|marginwidth|marginheight|scrolling|align|width|height][#|Y]'+'h3[E|align][#|S]'+'tt[E][#|S]'+'i[E][#|S]'+'b[E][#|S]'+'u[E][#|S]'+'s[E][#|S]'+'strike[E][#|S]'+'big[E][#|S]'+'small[E][#|S]'+'font[A|B|size|color|face][#|S]'+'basefont[id|size|color|face][]'+'em[E][#|S]'+'strong[E][#|S]'+'dfn[E][#|S]'+'code[E][#|S]'+'q[E|cite][#|S]'+'samp[E][#|S]'+'kbd[E][#|S]'+'var[E][#|S]'+'cite[E][#|S]'+'abbr[E][#|S]'+'acronym[E][#|S]'+'sub[E][#|S]'+'sup[E][#|S]'+'input[E|D|type|name|value|checked|disabled|readonly|size|maxlength|src|alt|usemap|onselect|onchange|accept|align][]'+'select[E|name|size|multiple|disabled|tabindex|onfocus|onblur|onchange][optgroup|option]'+'optgroup[E|disabled|label][option]'+'option[E|selected|disabled|label|value][]'+'textarea[E|D|name|rows|cols|disabled|readonly|onselect|onchange][]'+'label[E|for|accesskey|onfocus|onblur][#|S]'+'button[E|D|name|value|type|disabled][#|p|T|div|U|W|table|G|object|applet|img|map|K|N|Q]'+'h4[E|align][#|S]'+'ins[E|cite|datetime][#|Y]'+'h5[E|align][#|S]'+'del[E|cite|datetime][#|Y]'+'h6[E|align][#|S]'+'div[E|align][#|Y]'+'ul[E|type|compact][li]'+'li[E|type|value][#|Y]'+'ol[E|type|compact|start][li]'+'dl[E|compact][dt|dd]'+'dt[E][#|S]'+'dd[E][#|Y]'+'menu[E|compact][li]'+'dir[E|compact][li]'+'pre[E|width|xml:space][#|ZA]'+'hr[E|align|noshade|size|width][]'+'blockquote[E|cite][#|Y]'+'address[E][#|S|p]'+'center[E][#|Y]'+'noframes[E][#|Y]'+'isindex[A|B|prompt][]'+'fieldset[E][#|legend|Y]'+'legend[E|accesskey|align][#|S]'+'table[E|summary|width|border|frame|rules|cellspacing|cellpadding|align|bgcolor][caption|col|colgroup|thead|tfoot|tbody|tr]'+'caption[E|align][#|S]'+'col[ZG][]'+'colgroup[ZG][col]'+'thead[ZF][tr]'+'tr[ZF|bgcolor][th|td]'+'th[E|ZE][#|Y]'+'form[E|action|method|name|enctype|onsubmit|onreset|accept|accept-charset|target][#|X|R|Q]'+'noscript[E][#|Y]'+'td[E|ZE][#|Y]'+'tfoot[ZF][tr]'+'tbody[ZF][tr]'+'area[E|D|shape|coords|href|nohref|alt|target][]'+'base[id|href|target][]'+'body[E|onload|onunload|background|bgcolor|text|link|vlink|alink][#|Y]')}return h};t.html.Schema=function(c){var d=this,f={},h={},p=[],v,j;var w,k,l,n,o,q,r={};function x(i,E,F){var G=c[i];if(!G){G=m[i];if(!G){G=a(E,' ',a(E.toUpperCase(),' '));G=t.extend(G,F);m[i]=G}}else{G=a(G,',',a(G.toUpperCase(),' '))}return G};c=c||{};j=c.schema=="html5"?g():b();if(c.verify_html===false)c.valid_elements='*[*]';if(c.valid_styles){v={};e(c.valid_styles,function(i,E){v[E]=t.explode(i)})}w=x('whitespace_elements','pre script noscript style textarea');k=x('self_closing_elements','colgroup dd dt li option p td tfoot th thead tr');l=x('short_ended_elements','area base basefont br col frame hr img input isindex link meta param embed source wbr');n=x('boolean_attributes','checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls');q=x('non_empty_elements','td th iframe video audio object',l);textBlockElementsMap=x('text_block_elements','h1 h2 h3 h4 h5 h6 p div address pre form '+'blockquote center dir fieldset header footer article section hgroup aside nav figure');o=x('block_elements','hr table tbody thead tfoot '+'th tr td li ol ul caption dl dt dd noscript menu isindex samp option datalist select optgroup',textBlockElementsMap);function y(i){return new RegExp('^'+i.replace(/([?+*])/g,'.$1')+'$')};function z(i){var E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$=/^([#+\-])?([^\[\/]+)(?:\/([^\[]+))?(?:\[([^\]]+)\])?$/,_=/^([!\-])?(\w+::\w+|[^=:<]+)?(?:([=:<])(.*))?$/,a1=/[*?+]/;if(i){i=s(i);if(f['@']){U=f['@'].attributes;V=f['@'].attributesOrder}for(E=0,F=i.length;E<F;E++){J=$.exec(i[E]);if(J){S=J[1];N=J[2];T=J[3];M=J[4];Q={};R=[];K={attributes:Q,attributesOrder:R};if(S==='#')K.paddEmpty=true;if(S==='-')K.removeEmpty=true;if(U){for(X in U)Q[X]=U[X];R.push.apply(R,V)}if(M){M=s(M,'|');for(G=0,H=M.length;G<H;G++){J=_.exec(M[G]);if(J){L={};P=J[1];O=J[2].replace(/::/g,':');S=J[3];Z=J[4];if(P==='!'){K.attributesRequired=K.attributesRequired||[];K.attributesRequired.push(O);L.required=true}if(P==='-'){delete Q[O];R.splice(t.inArray(R,O),1);continue}if(S){if(S==='='){K.attributesDefault=K.attributesDefault||[];K.attributesDefault.push({name:O,value:Z});L.defaultValue=Z}if(S===':'){K.attributesForced=K.attributesForced||[];K.attributesForced.push({name:O,value:Z});L.forcedValue=Z}if(S==='<')L.validValues=a(Z,'?')}if(a1.test(O)){K.attributePatterns=K.attributePatterns||[];L.pattern=y(O);K.attributePatterns.push(L)}else{if(!Q[O])R.push(O);Q[O]=L}}}}if(!U&&N=='@'){U=Q;V=R}if(T){K.outputName=N;f[T]=K}if(a1.test(N)){K.pattern=y(N);p.push(K)}else f[N]=K}}}};function A(i){f={};p=[];z(i);e(j,function(E,F){h[F]=E.children})};function B(i){var E=/^(~)?(.+)$/;if(i){e(s(i),function(F){var G=E.exec(F),H=G[1]==='~',I=H?'span':'div',J=G[2];h[J]=h[I];r[J]=I;if(!H){o[J.toUpperCase()]={};o[J]={}}if(!f[J]){f[J]=f[I]}e(h,function(K,L){if(K[I])K[J]=K[I]})})}};function C(i){var E=/^([+\-]?)(\w+)\[([^\]]+)\]$/;if(i){e(s(i),function(F){var G=E.exec(F),H,I;if(G){I=G[1];if(I)H=h[G[2]];else H=h[G[2]]={'#comment':{}};H=h[G[2]];e(s(G[3],'|'),function(J){if(I==='-')delete H[J];else H[J]={}})}})}};function D(E){var F=f[E],i;if(F)return F;i=p.length;while(i--){F=p[i];if(F.pattern.test(E))return F}};if(!c.valid_elements){e(j,function(i,E){f[E]={attributes:i.attributes,attributesOrder:i.attributesOrder};h[E]=i.children});if(c.schema!="html5"){e(s('strong/b,em/i'),function(i){i=s(i,'/');f[i[1]].outputName=i[0]})}f.img.attributesDefault=[{name:'alt',value:''}];e(s('ol,ul,sub,sup,blockquote,span,font,a,table,tbody,tr,strong,em,b,i'),function(i){if(f[i]){f[i].removeEmpty=true}});e(s('p,h1,h2,h3,h4,h5,h6,th,td,pre,div,address,caption'),function(i){f[i].paddEmpty=true})}else A(c.valid_elements);B(c.custom_elements);C(c.valid_children);z(c.extended_valid_elements);C('+ol[ul|ol],+ul[ul|ol]');if(c.invalid_elements){t.each(t.explode(c.invalid_elements),function(i){if(f[i])delete f[i]})}if(!D('span'))z('span[!data-mce-type|*]');d.children=h;d.styles=v;d.getBoolAttrs=function(){return n};d.getBlockElements=function(){return o};d.getTextBlockElements=function(){return textBlockElementsMap};d.getShortEndedElements=function(){return l};d.getSelfClosingElements=function(){return k};d.getNonEmptyElements=function(){return q};d.getWhiteSpaceElements=function(){return w};d.isValidChild=function(i,E){var F=h[i];return!!(F&&F[E])};d.isValid=function(E,F){var G,i,H=D(E);if(H){if(F){if(H.attributes[F]){return true}G=H.attributePatterns;if(G){i=G.length;while(i--){if(G[i].pattern.test(E)){return true}}}}else{return true}}return false};d.getElementRule=D;d.getCustomElements=function(){return r};d.addValidElements=z;d.setValidElements=A;d.addCustomElements=B;d.addValidChildren=C;d.elements=f}})(tinymce);
