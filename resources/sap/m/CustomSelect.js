/*
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2013 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.m.CustomSelect");(function(_){var p="sap.ui.thirdparty.mobiscroll.",c=p+"css",P=!!sap.ui.core.theming.Parameters.get("sapMPlatformDependent"),a=P&&jQuery.os.android&&jQuery.os.fVersion===2.3,t=P?"android-ics light":"sapMCustomSlt";_.require("sap.m.InstanceManager");_.require(p+"js.mobiscroll-core");_.require(p+"js.mobiscroll-select");_.includeStyleSheet(_.getModulePath(c,"/")+"mobiscroll-core.css");if(P){_.includeStyleSheet(_.getModulePath(c,"/")+"mobiscroll-android-ics.css")}var C=function(d){var $=d.find(".dw"),D=$.outerHeight(true),f=$.outerWidth(true),w=document.documentElement.clientHeight,W=document.documentElement.clientWidth,b=d.find(".dw-persp");if(b.height()>w){b.height(w);b.find(".dw-arrw-i").css("display","none");$.css({top:Math.max((w-D)/2,0),left:Math.max((W-f)/2,0)})}};sap.m.Select.prototype._onBeforeRenderingCustom=function(){if(this._$Select){this._$Select.scroller("destroy")}};sap.m.Select.prototype._onAfterRenderingCustom=function(){var s=this,I=sap.m.InstanceManager,h=jQuery.proxy(this._handlePointerDown,this),H=jQuery.proxy(this._handleResizeEvent,this);if(this._$Select.length){this._$Select.scroller({cancelText:this._oRb.getText("SELECT_CANCEL"),setText:this._oRb.getText("SELECT_ACCEPT"),headerText:this.getTitle(),lang:this._sLang,delay:300,disabled:!this.getEnabled(),display:jQuery.device.is.phone?"modal":"bubble",mode:jQuery.device.is.phone||jQuery.device.is.tablet?"scroller":"mixed",preset:"select",showLabel:false,theme:t,width:80,height:40,inputClass:"sapMSltInput",rows:jQuery.device.is.phone?3:5,onMarkupReady:function($,S){if(s.getTitle()){$.addClass("sapMCustomSltHdr")}$[0].querySelector(".dwwr").style.maxWidth=(document.documentElement.clientWidth-40)+"px"},onShow:function($,v,S){!a&&!jQuery.device.is.phone&&document.addEventListener(jQuery.support.touch?"touchstart":"mousedown",h,true);jQuery(window).on("resize.sapMCustomSelect",{$domRef:$},H);I.addDialogInstance(s);S.settings.display==="bubble"&&C.call(this,$)},onClose:function(){!a&&!jQuery.device.is.phone&&document.removeEventListener(jQuery.support.touch?"touchstart":"mousedown",h,true);jQuery(window).off("resize.sapMCustomSelect",H);I.removeDialogInstance(s)}})}};sap.m.Select.prototype._handlePointerDown=function(e){if(!document.querySelector(".sapMCustomSlt .dwwr").contains(e.target)){this.close()}};sap.m.Select.prototype.close=function(){this._$Select.scroller("hide")};sap.m.Select.prototype._ontouchmoveCustom=function(e){e.stopPropagation();e.preventDefault()};sap.m.Select.prototype._handleResizeEvent=function(e){e.data.$domRef[0].querySelector(".dwwr").style.maxWidth=(document.documentElement.clientWidth-40)+"px"};if(a){sap.m.Select.prototype.onclick=function(e){this._$Select.scroller("show")}}})(jQuery.sap);
